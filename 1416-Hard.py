## 1416. Restore The Array
## A program was supposed to print an array of integers. The program forgot to print whitespaces and 
## the array is printed as a string of digits s and all we know is that all integers in the array were 
## in the range [1, k] and there are no leading zeros in the array.

## Given the string s and the integer k, return the number of the possible arrays that can be printed as 
## s using the mentioned program. Since the answer may be very large, return it modulo 109 + 7.

def numberOfArrays(s, k):
    if int(s[0])>k:
        return 0
    count=[0]*(len(s)+1)
    count[0]=1
    count[1]=1 
    for i in range(1, len(s)):
        for j in range(i,-1,-1):
            if int(s[j:i+1])<=k and s[j]!='0':
                count[i+1]+=count[j]
            if int(s[j:i+1])>k:
                break
        if count[i-1]==0:
            break
    return count[-1]%(10**9+7)

if __name__=='__main__':
    s="6300988793128824511853021957220525043738760339025464830436992222409273010074820428525903337547659862817693015346287473611171350478792555044497217960815838849076516688162655366051932735063562871843320664387124813714632299687044715551825863287405038147251907111874917204069665848665666233925003463722485316550243236974073761415182610484663155544191296815472240992501429260121549092974474880983985292015386126557135061114089246971903848384176471429735448746557617763264691548271882773124135021339325056315532626194600480449013211946481307429673757774567273679625443991337253991587037151246559169984786088553715839721570514221310653608195907452830650349826454340924850207371476286078176487871992644456344456054938161953567521994441594152142701012350146851013193951344995255248862792371361582545396392612783188553591390540872128690143819153437290639634184878177111408805953093976671779051904168121936105922515760573155558759894326902994495467245074458894730932131131523836486903591023402617206913797287365713835658073275699437889328261521735372020956227395160309147681335509670547207832056387516672567744776266946656559739917941766913605147740142291742429505791869111904587612233892332843448723267350306016072713793512161360227403732121133720206836823657005979572791532403266451149596123185878491580259333595043143349176463706299653386097433732948849773459334616786506952139391309955596374402795515813321445036745433074552286131362610984015914803279628112063671355720885250136792472586851153231355427420706767132495543049598372809536842772352299230588395212442452985900448544543435644923442152095808390424036818031275737503799163762099804643357752436584765464259224262215233746225246156798033484059797631309891360013523190963121636047256549980361843792707140181805254287382944411356136956646040802956881637605129820123217025443712791840386140625866035918605550092299648554759166046066486361314727774699190813869102462063183252153704872323356289327425023333252239346393652320603234372822161255793355711863675701205594417123714492085393626879045634791413635241919450398830636854521238576592363969863139277518034376603470930356869053961732306567975627336710148036535940343991036823006132497294417884562403903755929814204796636669753695422087024871"
    k=731671255
    print(numberOfArrays(s,k))